# 🎓 AI-TA-Grader 使用指南

## 🚀 快速開始

### 方式一：完整模式（推薦）
1. **獲取API金鑰**: 前往 [Google AI Studio](https://aistudio.google.com/) 獲取免費的Gemini API金鑰
2. **啟動程式**: 運行 `python app.py` 
3. **輸入金鑰**: 在界面中貼上您的API金鑰
4. **上傳檔案**: 拖曳您的CSV考卷檔案到指定區域
5. **開始分析**: 點擊「開始分析」按鈕

**功能包含**:
- ✅ AI書寫風格檢測（0-100分）
- ✅ 自動評分輔助
- ✅ GenAI + 非GenAI雙重相似度檢測
- ✅ 完整視覺化相似度矩陣

### 方式二：離線模式（無需API）
1. **啟動程式**: 運行 `python app.py`
2. **跳過金鑰**: 將API金鑰欄位留空
3. **上傳檔案**: 拖曳您的CSV考卷檔案到指定區域  
4. **開始分析**: 點擊「開始分析」按鈕

**功能包含**:
- ✅ 工業級非GenAI相似度檢測（6種算法融合）
- ✅ 視覺化相似度矩陣
- ✅ 詳細統計分析報告
- ❌ AI書寫風格檢測（需要API）
- ❌ 自動評分（需要API）

## 📊 分析結果說明

### 相似度分級
- **🚨 2級（高度相似）**: 相似度 ≥ 75% - 疑似抄襲，需要詳細調查
- **⚠️ 1級（中等相似）**: 相似度 60-75% - 需要關注，可能存在協作
- **✅ 0級（無明顯相似）**: 相似度 < 60% - 正常情況

### 視覺化矩陣解讀
- **紅色熱力圖**: GenAI語義相似度分析（需要API）
- **藍色熱力圖**: 非GenAI多算法相似度分析
- **數值**: 相似度分數（0.000-1.000）
- **下三角顯示**: 避免重複，只顯示學生間的相似度關係

### 報告格式
- **Excel (.xlsx)**: 適合進一步數據分析
- **CSV (.csv)**: 適合導入其他系統
- **YAML (.yaml)**: 適合程式化處理
- **HTML (.html)**: 適合人工閱讀，包含視覺化圖表

## 🔧 進階設定

### CSV檔案格式要求
```csv
name,question_column_1,question_column_2,...
學生姓名1,答案1,答案2,...
學生姓名2,答案1,答案2,...
```

### 自訂評分題目
修改 `analyzer.py` 中的 `TARGET_SCORE_Q` 列表：
```python
TARGET_SCORE_Q = [1, 2, 3, 4, 11]  # 需要評分的題目編號
```

### 調整相似度閾值
修改 `alternative_similarity_methods.py` 中的閾值設定：
```python
# 在 calculate_text_similarity_enhanced 函數中
if max_similarity >= 0.80:      # 高度相似閾值
    results.append(2)
elif max_similarity >= threshold:  # 中等相似閾值（默認0.6）
    results.append(1)
```

## 🛠️ 疑難排解

### 常見問題

**Q: 為什麼相似度檢測結果都是0？**
A: 可能是文本太短或差異太大。非GenAI方法對於極短文本（<50字符）敏感度較低。

**Q: 視覺化圖片顯示亂碼？**  
A: 這是中文字體問題，不影響分析結果，只影響圖表標籤顯示。

**Q: API金鑰無效？**
A: 請確認：
1. 金鑰格式正確（以 `AIza` 開頭）
2. API服務已啟用
3. 配額未超限

**Q: 分析過程卡住？**
A: 可能原因：
1. 網路連接問題（完整模式）
2. 學生數量過多（建議分批處理）
3. 檔案格式問題（檢查CSV格式）

### 性能建議
- **學生數量**: 建議單次分析 < 100位學生
- **記憶體**: 建議系統記憶體 ≥ 4GB
- **網路**: 完整模式需要穩定的網路連接

## 📞 技術支援

如遇到問題，請檢查：
1. **系統需求**: Python 3.8+, 4GB+ RAM
2. **依賴套件**: 運行 `pip install -r requirements.txt`
3. **錯誤日誌**: 查看程式運行時的日誌輸出
4. **測試模式**: 使用提供的測試檔案驗證功能

---

**提示**: 離線模式的相似度檢測採用與Turnitin等商業系統類似的核心算法，具有工業級的檢測能力，完全可以滿足日常的抄襲檢測需求。
